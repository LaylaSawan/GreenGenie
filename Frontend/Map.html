<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>FireSense Map</title>

    <!-- Custom fonts for this template-->
    <link href="vendor/fontawesome-free/css/all.min.css" rel="stylesheet" type="text/css">
    <link
        href="https://fonts.googleapis.com/css?family=Nunito:200,200i,300,300i,400,400i,600,600i,700,700i,800,800i,900,900i"
        rel="stylesheet">

    <!-- Custom styles for this template-->
    <link href="css/sb-admin-2.min.css" rel="stylesheet">

</head>

<body id="page-top">

    <!-- Page Wrapper -->
    <div id="wrapper">

        <!-- Sidebar -->
        <ul class="navbar-nav bg-gradient-success sidebar sidebar-dark accordion" id="accordionSidebar">

            <!-- Sidebar - Brand -->
            <a class="sidebar-brand d-flex align-items-center justify-content-center" href="index.html">
                <div class="sidebar-brand-icon">
                    <img class="img-fluid" src="file:///C:/Users/LaylaS/Downloads/image-removebg-preview (5).png" alt="ForestSense Logo">
                </div>
                <div class="sidebar-brand-text mx-2">ForestSense</div>
            </a>

            <!-- Divider -->
            <hr class="sidebar-divider my-0">

            <!-- Nav Item - Dashboard -->
            <li class="nav-item">
                <a class="nav-link" href="index.html">
                    <i class="fas fa-fw fa-tachometer-alt"></i>
                    <span>Dashboard</span></a>
            </li>

            <!-- Divider -->
            <hr class="sidebar-divider">

            <!-- Heading -->
            <div class="sidebar-heading">
                Interface
            </div>

            <!-- Nav Item - Pages Collapse Menu -->
            <li class="nav-item">
                <a class="nav-link collapsed" href="#" data-toggle="collapse" data-target="#collapseTwo"
                    aria-expanded="true" aria-controls="collapseTwo">
                    <i class="fas fa-fw fa-cog"></i>
                    <span>Forest Sense</span>
                </a>
                <div id="collapseTwo" class="collapse" aria-labelledby="headingTwo" data-parent="#accordionSidebar">
                    <div class="bg-white py-2 collapse-inner rounded">
                        <a class="collapse-item" href="buttons.html">Purpose of Forest Sense?</a>
                        <a class="collapse-item" href="cards.html">Next steps</a>
                    </div>
                </div>
            </li>

            <!-- Nav Item - Utilities Collapse Menu -->
            <li class="nav-item active">
                <a class="nav-link" href="#" data-toggle="collapse" data-target="#collapseUtilities"
                    aria-expanded="true" aria-controls="collapseUtilities">
                    <i class="fas fa-fw fa-wrench"></i>
                    <span>Real-Time Values</span>
                </a>
                <div id="collapseUtilities" class="collapse show" aria-labelledby="headingUtilities"
                    data-parent="#accordionSidebar">
                    <div class="bg-white py-2 collapse-inner rounded">
                        <a class="collapse-item active" href="utilities-color.html">Map</a>
                        <a class="collapse-item" href="utilities-border.html">Charts</a>
                        <a class="collapse-item" href="utilities-animation.html">Images</a>
                    </div>
                </div>
            </li>

            <!-- Divider -->
            <hr class="sidebar-divider">

            <!-- Heading -->
            
        </ul>
        <!-- End of Sidebar -->

        <!-- Content Wrapper -->
        <div id="content-wrapper" class="d-flex flex-column">

            <!-- Main Content -->
            <div id="content">

                <!-- Topbar -->
               
                <!-- End of Topbar -->

                <!-- Begin Page Content -->
                <div class="container-fluid">

                    <!-- Page Heading -->
                    <h1 class="h3 mb-1 text-gray-800">Color Utilities</h1>
                    <p class="mb-4">Bootstrap's default utility classes can be found on the official <a
                            href="https://getbootstrap.com/docs">Bootstrap Documentation</a> page. The custom utilities
                        below were created to extend this theme past the default utility classes built into Bootstrap's
                        framework.</p>

                    <!-- Content Row -->
                    <!--here layla!-->
                    <link href="https://api.mapbox.com/mapbox-gl-js/v3.0.1/mapbox-gl.css" rel="stylesheet">
    <script src="https://api.mapbox.com/mapbox-gl-js/v3.0.1/mapbox-gl.js"></script>
    <style>
        body { margin: 0; padding: 0; }
        #map { position: absolute; top: 0; bottom: 0; width: 100%;}
        .marker {
            background-image: url('');
            background-size: cover;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            cursor: pointer;
        }

        .mapboxgl-popup {
            max-width: 200px;
        }

        .mapboxgl-popup-content {
            text-align: center;
            font-family: 'Open Sans', sans-serif;
        }
    </style>
<div id="map"></div>

<script>
    mapboxgl.accessToken = 'pk.eyJ1IjoibGF5bGFzYXdhbiIsImEiOiJjbHF2Z3I4azc1c2d1MnJtdW91OXZvOWF6In0.Bu50ecvGSNKMRhc0Ce6EDw';
    const map = new mapboxgl.Map({
        container: 'map',
        style: 'mapbox://styles/mapbox/light-v11',
        center: [-68.137343, 45.137451],
        zoom: 5
    });

    const apiUrl = 'https://k1z4zgvk39.execute-api.us-east-2.amazonaws.com/DepA/';

    let geojson = {
        'type': 'FeatureCollection',
        'features': []
    };

    fetch(apiUrl)
        .then(response => {
            if (!response.ok) {
                throw new Error('Network response was not ok');
            }
            return response.json();
        })
        .then(data => {
            data.forEach(point => {
                data.forEach(item =>{
                const node = point["node"];
                const co = point["co"];
                const co2 = point["co2"];
                const flame = point["flame"];
                const temp = point["temp"];
                const humidity = point["humidity"];
                const date_time = point["date_time"];

                });

                console.log(data)
                console.log(point)
                console.log(point.sensorData)
                console.log(point.sensorData[0])
                console.log(point.sensorData[0]["co2"])
                
                var color_red = '#880808';
                var color_yellow = '#FFC300';
                var color_green = '#50C878';

                var currentColor;

            if (point.sensorData[0]["co2"] >= 1000 && point.sensorData[0]["co2"] <= 2000) {
                currentColor = color_green;
            }else if (point.sensorData[0]["co2"] >= 3000 && point.sensorData[0]["co2"] <= 4000) {
                currentColor = color_red;
            } else {
                currentColor = color_yellow;
            }

                new mapboxgl.Marker({ color: currentColor })
                    .setLngLat([point.longitude, point.latitude])
                    .setPopup(
                        new mapboxgl.Popup({ offset: 25 })
                            .setHTML(
                                `<h3>Node: ${point.node}</h3><p> <u><b>CO: </b></u> ${point.sensorData[0]["co"]}, <br> <u><b>CO2: </b></u> ${point.sensorData[0]["co2"]}, <br> <u><b>Flame: </b></u> ${point.sensorData[0]["flame"]}, <br><u><b>Temperature: </b></u> ${point.sensorData[0]["temp"]}, <br> <u><b>Humidity: </b></u> ${point.sensorData[0]["humidity"]}, <br> <u><b>Date: </b></u> ${point.sensorData[0]["date_time"]}  </p>`
                            )
                    )
                    .addTo(map);
            });

            console.log("Done.");
        })
        .catch(error => {
            console.error('Error:', error);
        });

    map.on('load', () => {
        map.addSource('maine', {
            'type': 'geojson',
            'data': {
                'type': 'Feature',
                'geometry': {
                    'type': 'Polygon',
                    'coordinates': [
                        [
                            [0, 0]
                        ]
                    ]
                }
            }
        });

        map.addLayer({
            'id': 'maine',
            'type': 'fill',
            'source': 'maine',
            'layout': {},
            'paint': {
                'fill-color': '#FF0000',
                'fill-opacity': 0.5
            }
        });

        map.addLayer({
            'id': 'outline',
            'type': 'line',
            'source': 'maine',
            'layout': {},
            'paint': {
                'line-color': '#1B3D0F',
                'line-width': 3
            }
        });
    });
</script>
            <!-- End of Main Content -->

            <!-- Footer -->
            <footer class="sticky-footer bg-white">
                <div class="container my-auto">
                    <div class="copyright text-center my-auto">
                        <span>Copyright &copy; Your Website 2020</span>
                    </div>
                </div>
            </footer>
            <!-- End of Footer -->

        </div>
        <!-- End of Content Wrapper -->

    </div>
    <!-- End of Page Wrapper -->

    <!-- Scroll to Top Button-->
    <a class="scroll-to-top rounded" href="#page-top">
        <i class="fas fa-angle-up"></i>
    </a>


    <!-- Bootstrap core JavaScript-->
    <script src="vendor/jquery/jquery.min.js"></script>
    <script src="vendor/bootstrap/js/bootstrap.bundle.min.js"></script>

    <!-- Core plugin JavaScript-->
    <script src="vendor/jquery-easing/jquery.easing.min.js"></script>

    <!-- Custom scripts for all pages-->
    <script src="js/sb-admin-2.min.js"></script>

</body>

</html>
